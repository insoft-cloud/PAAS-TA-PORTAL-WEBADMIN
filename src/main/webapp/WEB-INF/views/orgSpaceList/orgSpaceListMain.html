<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="../layout/default">
<head></head>
<body>
<div class="wrapper">
    <header></header>
    <div layout:fragment="content">
        <section class="content-header">
            <h3>
                조직 및 공간 관리
            </h3>
        </section>
        <section class="content">
            <div class="row">
                <div class="col-xs-12">
                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"></h3>
                            <div class="box-tools" style="width: 496px; padding-right: 21px;">
                                <div class="input-group input-group-sm" style="width: 393px; float: left;">
                                    <input type="text"  name="table_search" class="form-control pull-right" placeholder="Search" id="org-searchKeyword" onkeyup="searchOrg()"/>
                                    <div class="input-group-btn" >
                                        <button type="submit"  class="btn btn-default" onclick="searchOrg()"><i class="fa fa-search"></i></button>
                                    </div>
                                </div>
                                <div class="pull-right" style="padding-right: 0px; ">
                                    <button type="button" class="btn btn-block btn-primary btn-sm" data-title-text="조직 할당량 등록" id="devEnvRegistBtn" name="registBtn" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#devEnvFormModal">
                                        조직 등록
                                    </button>
                                </div>
                            </div>
                                <div style="height: 10px">
                            </div>
                            <div class="col-md-3 col-sm-6 col-xs-12" style="width: 49%">
                                <table class="table table-bordered table-striped dataTable" style="text-align: center; display: none" id="orgTable" >
                                </table>
                                <div id="noOrgMessage" class='box-header with-border' style="display: none">생성된 조직이 없습니다.</div>
                                <div id="noSearchOrgMessage" class='box-header with-border' style="display: none">검색된 조직이 없습니다.</div>
                            </div>
                            <div class="box-body table-responsive no-padding" style="width: 49%">
                                <table class="table table-bordered table-striped dataTable" style="text-align: center; display: none" id="spaceTable" >
                                </table>
                                <div id="noSpaceMessage" class='box-header with-border' style="display: none">생성된 공간이 없습니다.</div>
                            </div>
                        <!-- /.box-header -->

                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </div>

            </div>
            </div>
            <div class="modal fade" id="modal-default" style="display: none;">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span></button>
                        <h4 class="modal-title" id="modaltitle">Default Modal</h4>
                    </div>
                    <div class="modal-body" id="modalbody">
                        <p>One fine body…</p>
                    </div>
                    <div class="modal-footer" id="modal-footer">
                        <!--<button type="button" class="btn btn-primary" data-dismiss="modal">확인</button>-->
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>


            <!-- [조직 등록] Modal -->
            <div class="modal fade" id="devEnvFormModal" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span></button>

                            <h4 class="modal-title">
                                <div id="devEnvTitle" name="modalTitle">조직 등록</div>
                            </h4>
                        </div>
                        <div class="modal-body">

                            <div class="box" style="margin-bottom: 0px; border-top: 0px; box-shadow: 0 0px 0px">
                                <div id="devEnvModalLoadingBar" name="modalLoadingBar" class="overlay hide"><i class="fa fa-refresh fa-spin"></i></div>
                                <form id="devEnvForm" class="form-horizontal">
                                    <div class="box-body">

                                        <div class="form-group required">
                                            <label for="orgName" class="col-sm-3 control-label">조직 이름</label>
                                            <div class="col-sm-9">
                                                <input type="text" class="form-control checkDevEnvForm" id="orgName" onkeyup='pattenTest2()' placeholder="조직 이름을 입력해주세요." />
                                            </div>
                                        </div>

                                        <div class="form-group required">
                                            <label for="spaceName" class="col-sm-3 control-label">공간 이름</label>
                                            <div class="col-sm-9">
                                                <input type="text" class="form-control checkDevEnvForm" id="spaceName" onkeyup='pattenTest2()' placeholder="공간 이름을 입력해주세요/"/>
                                            </div>
                                        </div>

                                    <div id="selectOS">
                                        <div class="form-group" style="height:50px;" id="orgSelect">
                                            <label for="orgInput" class="col-sm-3 col-xs-12 control-label">조직 권한</label>
                                            <div class="col-sm-4 col-xs-3">
                                                <select class="form-control" id="orgInput">
                                                    <option value="N">조직을 선택해주세요.</option>
                                                    <option value="OrgManager">OrgManager</option>
                                                    <option value="BillingManager">BillingManager</option>
                                                    <option value="OrgAuditor">OrgAuditor</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group" style="height:50px;" id="spaceSelect">
                                            <label for="spaceInput" class="col-sm-3 col-xs-12 control-label">공간 권한</label>
                                            <div class="col-sm-4 col-xs-3">
                                                <select class="form-control" id="spaceInput">
                                                    <option value="N">공간을 선택해주세요.</option>
                                                    <option value="SpaceManager">SpaceManager</option>
                                                    <option value="SpaceDeveloper">SpaceDeveloper</option>
                                                    <option value="SpaceAuditor">SpaceAuditor</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                        <div class="form-group" style="height:50px;">
                                            <label for="orgQuota" class="col-sm-3 col-xs-12 control-label">조직 할당량</label>
                                            <div class="col-sm-4 col-xs-3">
                                                <select class="form-control" id="orgQuota">
                                                    <option value="N">선택안함</option>
                                                </select>
                                            </div>
                                            <div class="col-sm-1 col-xs-3" style="margin-left: 15px;">
                                                <button class="user_btn colors1" id="selectOQ" style="position: absolute;top: 6px;left: -8px;" disabled="disabled" >선택안함</button>
                                            </div>
                                        </div>

                                        <div class="form-group" style="height:50px;">
                                            <label for="spaceQuota" class="col-sm-3 col-xs-12 control-label">공간 할당량</label>
                                            <div class="col-sm-4 col-xs-3">
                                                <select class="form-control" id="spaceQuota">
                                                    <option value="N">선택안함</option>
                                                </select>
                                            </div>
                                            <div class="col-sm-1 col-xs-3" style="margin-left: 15px;">
                                                <button class="user_btn colors1" id="selectSQ" style="position: absolute;top: 6px;left: -8px;" disabled="disabled">선택안함</button>
                                            </div>
                                        </div>

                                    </div>
                                </form>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" id="devEnvCloseBtn" class="btn btn-sm btn-default pull-left" data-dismiss="modal">취소</button>
                            <button type="button" id="devEnvRegBtn" name="modalRegBtn" class="btn btn-sm btn-primary pull-right" onclick="createOrg()">등록</button>
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>
            <!-- Modal END -->

</section>
    </div>
    <footer></footer>
</div>
<script layout:fragment="custom-script">
    var V2_URL = "/v2";
    var GET_ORGS_FOR_ADMIN_URL = V2_URL + "/orgs";
    var OrgAndSpace = "/OrgAndSpace";
    var Space = "/Space";
    var domainNames;
    var currentOrg;
    var spaces;
    var quotaName;
    var totalRoutes;
    var paidServices;
    var totalServices;
    var MemoryLimit;
    var OrgId;
    var quotaNameSpace;
    var totalRoutesSpace;
    var paidServicesSpace;
    var spaceQuotaText;

    var ORG_SOURCE_LIST;
    var SPACE_SOURCE_LIST;

    var orgObj = new Object();

    $(document).ready(function(){
        if($.cookie("api_key") != null){
            key = $.cookie("api_key");
            $("#apiUrls").val(key);
        }else{
            key = $("#apiUrls").val();
        }
        getInitMarketPlaceURL();
        procCallAjax2(GET_ORGS_FOR_ADMIN_URL+"?key="+key,"GET",null ,procCallbackGetOrgs);
        getDomains(key);

        procCallAjax("/v2/orgs/quota-definitions"+"?key="+key, "GET", null, procCallbackGetOrgQuotaDefinitionList,null);

        procCallAjax("/v2/spaces/quota-definitions"+"?key="+key, "GET", null, procCallbackGetSpaceQuotaDefinitionList,null);
    });

    $( "#apiUrls" ).change(function() {
        key = $("#apiUrls").val();
        $.cookie("api_key",key);

        $("#orgTable *").remove();
        $("#spaceTable *").remove();

        procCallAjax2(GET_ORGS_FOR_ADMIN_URL+"?key="+key,"GET",null ,procCallbackGetOrgs);

        getDomains(key);
    });


    /*<![CDATA[*/
    function getDomains(key) {


        $.ajax({
            url: V2_URL+ "/domains/shared/"+"?key="+key,
            method: "GET",
            dataType: 'json',
            contentType: "application/json",
            success: function (data) {
                if (data) {
                    domainNames = "";
                    for (var i = 0; i < data.resources.length; i++) {
                        if (i != 0) domainNames += " , ";
                        domainNames += data.resources[i].entity.name;
                    }
                }
            }
        });
    }



    var procCallbackGetOrgs = function (data, param) {
        $("#orgTable").hide();
        $("#noSpaceMessage").hide();

        if(data.resources.length === 0){
            $("#noOrgMessage").show();
        } else {
            $("#orgTable").append(
                    "<tbody>"+
                    "<tr>"+
                    "<th style='text-align: center'>번호</th>"+
                    "<th style='text-align: center'>조직 이름</th>"+
                    "<th style='text-align: center'>관리</th>"+
                    "</tr>"

            )
            orgObj = new Object();
            var orgName = new Array();
            var idMap = new Map();
            var QuotaMap = new Map();
            for (var i = 0; i < data.resources.length; i++) {
                orgName[i] = data.resources[i].entity.name;
                idMap.set(orgName[i],data.resources[i].metadata.guid);
                QuotaMap.set(orgName[i],data.resources[i].entity.quotaDefinitionId);
            }
            orgName.sort();
            for (var i = 0; i < data.resources.length; i++) {
                $("#orgTable").append (
                    "<tr id='orgSpaceViewArea-table-content-org-no" + (i + 1) + "' name='" + orgName[i].toString().toLowerCase() + "' >" +
                    "<td>" + (i + 1) + "</td>" +
                    "<td><a style='color: black' href='#none' id='orgNameList' onClick=\"getSpacesForAdmin('" + idMap.get(orgName[i]) + "','" + orgName[i] + "','" + (i+1) + "')\">" + orgName[i] + "</a> &nbsp;<a href='#none' onClick=\"procGetOrgSummary('" + idMap.get(orgName[i]) + "','" +  QuotaMap.get(orgName[i]) + "')\" style='font-size:10px;' data-toggle='modal' data-target='#modal-default'>[상세정보]</a></td>" +
                    "<label><input name='groupTable-checkbox' id='groupTable-checkbox-no-"+(i+1)+"' value='"+(i+1)+"' class='checkbox-inline' type='checkbox' style='display: none'></label>"+
                    '<td>'+
                    '<div>'+
                    '<label class="fa fa-gears" style="cursor: pointer;" href="#none" data-toggle="modal" data-target="#modal-default" onClick="procManagement(\''+idMap.get(orgName[i])+'\',\''+orgName[i]+'\',1)"></label>'+
                    '</div></td></tr>'
                )
                orgObj[orgName[i]] = orgName[i];
            }
            $("#orgTable").append (
                    "</tbody>"
            )
            changeTableContentColor("org")
            $("#orgTable").show();
            getSpacesForAdmin(idMap.get(orgName[0]),orgName[0], 1);
        }
    }

    function procManagement(guid,name,flag){
        $("#modalbody").html("데이터를 불러오고 있습니다.");

        if(flag==1){
            $("#modaltitle").html("조직 관리");
            $("#modalbody").html("<input maxlength='25' style='width: 80%;height: 33px; float: left;font-size: 19px;' placeholder='변경할 조직이름을 입력해주세요.' onkeyup='pattenTest()' id='ManagementName' readonly type='text' value="+name+">"+"<button type='button' style='margin-left: 15px;' class='btn btn-primary' onclick=\'changeReadOnly()\'>변경하기</button>");
            $("#modal-footer").html("<button type=\"button\" class=\"btn btn-sm btn-danger pull-left\">삭제</button>"+
                "<button type=\"button\" class=\"btn btn-sm btn-default pull-left\" data-dismiss=\"modal\">취소</button>"+
                "<button type='button' class='btn btn-primary'  data-dismiss=\"modal\" onclick='updateChek(1)'>수정</button>"+
                    "<input type='hidden' id='guid' value="+guid+">"
            );
        }else if(flag==2){
            $("#modaltitle").html("공간 관리");
            $("#modalbody").html("<input maxlength='25' style='width: 80%;height: 33px; float: left;font-size: 19px;' placeholder='변경할 공간 이름을 입력해주세요.' onkeyup='pattenTest()' id='ManagementName' readonly type='text' value="+name+">"+"<button type='button' style='margin-left: 15px;' class='btn btn-primary' onclick=\'changeReadOnly()\'>변경하기</button>");
            $("#modal-footer").html("<button type=\"button\" class=\"btn btn-sm btn-default pull-left\" data-dismiss=\"modal\">취소</button>"+
                "<button type='button' class='btn btn-primary' data-dismiss=\"modal\" onclick='updateChek(2)'>수정</button>"+
                "<input type='hidden' id='guid' value="+guid+">"
            );
        }

    }
    function createOrg() {
        $("#devEnvForm input[type=text]").each(function () {
            if(this.value.length==0 || this.value ==null){
                alert("내용을 입력해주세요.");
                this.focus();
                return false;
            }
        });
    }

    function updateChek(flag) {
        var name=$("#ManagementName").val();
        if(name.length == 0 || name == null){
            notifyAlert("warning", "", "내용을 입력해주세요.");
            return false;
        }else if(orgObj[name] != undefined) {
            notifyAlert("warning", "", name+" 은(는) 이미 사용중인 ID 입니다.");
            return false;
        }

    }

    function pattenTest() {
        var patten = /[\{\}\[\]\/@?,;:|\)*~`!^+<>\#$%&\\\=\(\'\"]/gi;
        $('#ManagementName').val($('#ManagementName').val().replace(patten, ''));
    }
    function pattenTest2() {
        var patten = /[\{\}\[\]\/@?,;:|\)*~`!^+<>\#$%&\\\=\(\'\"]/gi;
        $("#devEnvForm input[type=text]").each(function () {
            $(this).val($(this).val().replace(patten, ''));
        });
    }

    function changeReadOnly(){
        $("#ManagementName").removeAttr("readonly");
        $("#ManagementName").focus();
    }

    function getSpacesForAdmin(orgid, orgName, orgNum){
        $("#spaceTable").hide();
        $("#noSpaceMessage").hide();
        currentOrg = orgName;
        procCallAjax2(GET_ORGS_FOR_ADMIN_URL+"/"+orgid+"/spaces"+"?key="+key,"GET" ,null ,procCallbackGetSpace);
        contentSelectControl("group", orgNum);
    }

    //org 권한
    $(document).on("change keyup","select[id=orgInput]",function(){
         var value = $('#orgInput').val();
         if(value!='N'){
             $("#orgInput option[value='"+value+"']").remove();
             $("#orgSelect").append(
                 '<div id ="orgOutput" class="col-sm-1 col-xs-3" style="width: 102px; height: 100%; margin-left: 15px;" ><button type="button" class="user_btn colors2"'+
                 ' style="position: absolute;top: 6px;left: -8px;" onclick="getManagment(\''+value+'\')">'+value+'</button></div>'
             );
         }
    })

    function getManagment(val){
        /*
        $("#orgInput").append("<option value='"+val+"'>"+val+"</option>");
        $("#orgOutput").remove();*/
        $("#selectOS button").each(function () {
            if($(this).text() == val){
                $(this).parent().parent().children().find('select').append("<option value='"+val+"'>"+val+"</option>");
                $(this).parent().remove();
            }
        });
    }

    //space 권한
    $(document).on("change keyup","select[id=spaceInput]",function(){
         var value = $('#spaceInput').val();
        if(value!='N'){
            $("#spaceInput option[value='"+value+"']").remove();
            $("#spaceSelect").append(
                '<div id ="spaceOutput" class="col-sm-1 col-xs-3" style="width: 102px; height: 100%; margin-left: 15px;"><button type="button" class="user_btn colors2"'+
                ' style="position: absolute;top: 6px;left: -8px;" onclick="getManagment(\''+value+'\')">'+value+'</button></div>'
            );
        }
    })

    // 조직 할당량
    $(document).on("change keyup","select[id=orgQuota]",function(){
        var value = $('#orgQuota option:checked').text();
        if(value != 'N'){
            $('#selectOQ').text(value);
        }else{
            $('#selectOQ').text("선택안함");
        }
    })

    //공간 할당량
    $(document).on("change keyup","select[id=spaceQuota]",function(){
        var value = $('#spaceQuota option:checked').text();
        if(value != 'N'){
            $('#selectSQ').text(value);
        }else{
            $('#selectSQ').text("선택안함");
        }
    })

    var procCallbackGetSpace = function(data, param) {
        $("#spaceTable *").remove();
        $("#spaceTable").hide();
        $("#noSpaceMessage").hide();

        if(data.spaceList.resources.length === 0){
            $("#noSpaceMessage").show();
        } else {
            $("#spaceTable").append(
                    "<tbody>"+
                    "<tr>"+
                    "<th style='text-align: center'>번호</th>"+
                    "<th style='text-align: center'>"+currentOrg+" 공간 이름</th>"+
                    "<th style='text-align: center;width: 93px;'>관리</th>"+
                    "</tr>"
            )
            $.each(data.spaceList.resources, function (eventId, space) {
                $("#spaceTable").append (
                        "<tr id='orgSpaceViewArea-table-content-space-no"+(eventId+1)+"'>"+
                        "<td>"+(eventId+1)+"</td>"+
                        "<td>" + space.entity.name + "&nbsp; <a href='#none' onClick=\"procGetSpaceSummary('"+ space.metadata.guid +"','" + space.entity.space_quota_definition_guid + "')\" style='font-size:10px' data-toggle='modal' data-target='#modal-default'>[상세정보]</a></td>" +
                        '<td>'+
                        '<div>'+
                    '<label class="fa fa-gears" style="cursor: pointer;" href="#none" data-toggle="modal" data-target="#modal-default" onClick="procManagement(\''+space.metadata.guid+'\',\''+space.entity.name+'\',2)"></label>'+
                        '</div></td></tr>'
                )
            });
            $("#orgTable").append (
                    "</tbody>"
            )
            $("#spaceTable").show();
        }
    }

    // GET ORG SUMMARY
    var procGetOrgSummary = function (orgid, quotaid) {
        $("#modaltitle").html("조직 상세 정보");
        $("#modalbody").html("데이터를 불러오고 있습니다.");
        OrgId = orgid;
        //procCallAjax2(V2_URL + "/orgs/"+quotaid+"/quota","GET", null, procCallbackGetOrgQuota);
        //procCallAjax2(V2_URL + "/orgs/"+orgid+"/quota","GET", null, procCallbackGetOrgQuota);
        procCallAjax2(V2_URL + "/orgs/"+OrgId+"/summary"+"?key="+key, "GET",null, procCallbackGetOrgSummary);
        $("#modal-default .modal-footer").html("<button type='button' class='btn btn-primary' data-dismiss='modal'>확인</button>");
    };

    // GET ORG SUMMARY CALLBACK
    var procCallbackGetOrgQuota = function(data, param) {
        quotaName = data.entity.name;
        totalRoutes = data.entity.totalRoutes;
        totalServices = data.entity.totalServices;
        MemoryLimit = data.entity.memoryLimit;
        if (data.entity.nonBasicServicesAllowed) {
            paidServices = "paid services allowed";
        } else {
            paidServices = "paid services disallowed";
        }
        procCallAjax2(V2_URL + "/orgs/"+OrgId+"/summary"+"?key="+key, "GET",null, procCallbackGetOrgSummary);
    }

    // GET ORG SUMMARY CALLBACK
    var procCallbackGetOrgSummary = function(data, param) {

        spaces = "없음";
        for (var i = 0; i < data.resource.length; i++) {
            if (i != 0) spaces += " , " + data.resource[i].name;
            else spaces = data.resource[i].name;
        }
        $("#modalbody").html("<b>Domains</b> : " + domainNames +
                "<br><b>Quota</b> : " + data.quota.name + " (" + data.quota.memoryLimit + "M memory limit, " + data.quota.totalRoutes + " routes, " + data.all_serviceTotal + "/" + data.quota.totalServices + " services)" +
                "<br><b>Spaces</b> : " + spaces);
    }


    // GET SPACE SUMMARY
    var procGetSpaceSummary = function (spaceId, spaceQuotaId) {
        $("#modaltitle").html("영역 상세 정보");
        $("#modalbody").html("데이터를 불러오고 있습니다.");
        spaceQuotaText = "없음";

        if(spaceQuotaId != "null") {
            //procCallAjax2(V2_URL+"/spaces/quota-definitions/"+spaceQuotaId,"GET", null, procCallbackGetSpaceQuota);
            // To-Be : Quota 정보 관리 추가
        }

        procCallAjax2(V2_URL + "/spaces/"+spaceId+"/summary"+"?key="+key,"GET", null, procCallbackGetSpaceSummary);
        $("modal-default .modal-footer").html("<button type='button' class='btn btn-primary' data-dismiss='modal'>확인</button>");
    };


    // GET ORG SUMMARY CALLBACK
    var procCallbackGetSpaceQuota = function(data, param) {

        if (data.spaceQuota != null) {
            var spaceQuota = JSON.parse(data.spaceQuota);
            quotaNameSpace = spaceQuota.entity.name;
            totalRoutesSpace = spaceQuota.entity.total_routes;
            totalServicesSpace = spaceQuota.entity.total_services;
            if (spaceQuota.entity.non_basic_services_allowed) {
                paidServicesSpace = "paid services allowed";
            } else {
                paidServicesSpace = "paid services disallowed";
            }
            spaceQuotaText = quotaNameSpace + " (" + spaceQuota.entity.memory_limit + "M memory limit, " + totalRoutesSpace + " routes, " + totalServicesSpace + " services, " + paidServicesSpace + ")";
        } else {
            spaceQuotaText = "";
        }

        $("#modalbody").html("<b>Domains</b> : " + domainNames +
                "<br><b>Quota</b> : " + quotaName + " (" + MemoryLimit + "M memory limit, " + totalRoutes + " routes, " + totalServices + " services, " + paidServices + ")" +
                "<br><b>Spaces</b> : " + spaces);
    }

    // GET ORG SUMMARY CALLBACK
    var procCallbackGetSpaceSummary = function(data, param) {

        apps = "없음";
        for (var i = 0; i < data.apps.length; i++) {
            if (i != 0) apps += " , " + data.apps[i].name;
            else apps = data.apps[i].name;
        }

        services = "없음";
        for (var i = 0; i < data.services.length; i++) {
            if (i != 0) services += " , " + data.services[i].name;
            else services = data.services[i].name;
        }

        $("#modalbody").html(
                "<b>Org</b> : " + currentOrg +
                "<br><b>Space</b> : " + data.name +
                "<br><b>Apps</b> : " + apps +
                "<br><b>Domains</b> : " + domainNames +
                "<br><b>Services</b> : " + services +
                "<br><b>Quota</b> : " + spaceQuotaText);
    }




    function searchOrg() {
        $('#spaceTable').hide();
        $('#noSpaceMessage').hide();

        var input = $("#org-searchKeyword").val().toLowerCase();

        if(input === ""){
            $('#noSearchOrgMessage').hide();
            $('#orgTable').show();
            $('#orgTable tr[id*="orgSpaceViewArea-table-content-org-no"]').show();

        } else{
            $('#orgTable tr[id*="orgSpaceViewArea-table-content-org-no"]').hide();

            if($('#orgTable tr[name*="'+input+'"]').length > 0){
                $('#noSearchOrgMessage').hide();
                $('#orgTable').show();
                $('#orgTable tr[name*="'+input+'"]').show();

            } else{
                $('#orgTable').hide();
                $('#noSearchOrgMessage').show();
            }
        }
    }

    function changeTableContentColor(orgOrSpace) {
        var listToShow = $('#orgTable tr[id*="orgSpaceViewArea-table-content-org-no"]:not([style*="display: none"])')
        $.each(listToShow, function (eventId, eventData) {
            document.getElementById(eventData.id).className = "";
        });
    }

    function contentSelectControl(table, elementNo){
        if($("#"+table+"Table-checkbox-no-"+elementNo).is(":checked") === true) {
            $("#"+table+"Table-checkbox-no-"+elementNo).prop ("checked", false)
            if(table === "user"){
                var contentId = table+"Table-"+table+"-no-"+elementNo
                contentClassNameCategorize(elementNo ,contentId)
            } else {
                changeTableContentColor(table);
            }

        } else if($("#"+table+"Table-checkbox-no-"+elementNo).is(":checked") === false) {
            if(table === "group") {
                $(":checkbox[name='"+table+"Table-checkbox']").prop("checked", false);
                changeTableContentColor(table);
            }
            $("#"+table+"Table-checkbox-no-"+elementNo).prop ("checked",true)
            document.getElementById("orgSpaceViewArea-table-content-org-no"+elementNo).className = "bg-aqua disabled color-palette";
        }

    }
    function contentClassNameCategorize(contentNo, contnetId) {
        document.getElementById(contnetId).className = "";
    }

    //조직등록 모달 초기화
    $('#devEnvFormModal').on('hidden.bs.modal', function (e) {
        $("#selectOS button").each(function () {
            $(this).parent().parent().children().find('select').append("<option value='"+$(this).text()+"'>"+$(this).text()+"</option>");
            $(this).parent().remove();
        });


        $(this).find($("#selectSQ")).text("선택안함");
        $(this).find($("#selectOQ")).text("선택안함");
        $(this).find('form')[0].reset();
    });

    var procCallbackGetOrgQuotaDefinitionList = function(data){

        ORG_SOURCE_LIST = data.resources;
        printOrgData(ORG_SOURCE_LIST);
    };

    var procCallbackGetSpaceQuotaDefinitionList = function(data){

        SPACE_SOURCE_LIST = data.resources;
        printSpaceData(SPACE_SOURCE_LIST);
    };

    // 조직 할당량 정의 리스트 출력
    function printOrgData(dataList) {
        if(dataList.length == 0){
            $("#orgQuota option[value='N']").text("생선된 할당량이 없습니다.");
        }else{
            $.each(dataList, function (index, data) {
                $("#orgQuota").append("<option value='"+data.metadata.guid+"'>"+data.entity.name+"</option>");
            });
        }
    };

    // 공간 할당량 리스트 출력
    function printSpaceData(dataList) {
        if(dataList.length == 0){
            $("#spaceQuota option[value='N']").text("생선된 할당량이 없습니다.");
        }else{
            $.each(dataList, function (index, data) {
                $("#spaceQuota").append("<option value='"+data.metadata.guid+"'>"+data.entity.name+"</option>");
            });
        }
    };

    /*]]>*/
</script>
</body>
</html>
